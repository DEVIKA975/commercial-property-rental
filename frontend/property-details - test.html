<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Commercial Property — 4-Floor Building for Lease</title>
  
  <script src="js/config.js"></script>

  <style>
    /* ========== THEME VARIABLES ========== */
    :root{
      --bg: #f5f7fb;
      --card: #ffffff;
      --accent: #0f6fbd;
      --muted: #6b7280;

      /* container max width (desktop) - change this to scale the layout */
      --container-max-width: 1100px;

      /* map/base media heights (can be adjusted) */
      --media-height-mobile: 200px;
      --media-height-desktop: 320px;
      --map-height-mobile: 220px;
      --map-height-desktop: 300px;
    }

    /* ========== RESET / BASE ========== */
    * { box-sizing: border-box; }
    html,body { height: 100%; margin: 0; padding: 0; }
    
    body {
      display: flex;
      flex-direction: column; /* stack content + footer vertically */
      min-height: 100vh;      /* ensures body fills the viewport */
      font-family: Inter, system-ui, -apple-system, Arial, sans-serif;
      background: linear-gradient(rgba(255,255,255,0.3), rgba(255,255,255,0.3)), 
                  url("./images/Background.png");
      background-size: cover;       
      background-position: center;  
      background-attachment: fixed; 
      background-repeat: no-repeat; 
      color: #111;
      -webkit-font-smoothing: antialiased;
      -moz-osx-font-smoothing: grayscale;
      line-height: 1.4;
    }

    /* Mobile optimization */
    @media (max-width: 768px) {
      body {
        background-attachment: scroll; 
        background-position: top;      
      }
    }

    /* ========== LAYOUT WRAPPER ========== */
    .wrap {
      max-width: var(--container-max-width);
      margin: 32px auto;
      padding: 24px;
      width: 100%;
      background: linear-gradient(rgba(255,255,255,0.3), rgba(255,255,255,0.3));
      background-size: cover;  
    }
    
    /* card container for the listing */
    .card {
      background: var(--card);
      border-radius: 12px;
      padding: 20px;
      box-shadow: 0 6px 18px rgba(16,24,40,0.06);
    }

    /* header: hero image + title */
    header {
      display: flex;
      gap: 20px;
      align-items: center;
      flex-wrap: wrap;
    }

    /* left hero thumbnail (keeps images sharp) */
    .hero-img {
      flex: 1 1 260px;            
      border-radius: 8px;
      height: var(--media-height-desktop);
      background-size: cover;
      background-position: center;
      background-repeat: no-repeat;
      display: flex;
      align-items: center;
      justify-content: center;
      color: var(--muted);
      font-weight: 600;
      min-width: 220px;
    }

    .title { flex: 2 1 360px; min-width: 260px; }
    h1 { margin: 0; font-size: 22px; }
    .meta { color: var(--muted); margin-top: 6px; font-size: 14px; }

    /* ========== MAIN GRID ========== */
    .grid {
      display: grid;
      grid-template-columns: 1fr 360px; /* main + sidebar */
      gap: 20px;
      margin-top: 20px;
    }

    /* ========== LEFT COLUMN: Carousel / Content ========== */
    .carousel {
      position: relative;
      border-radius: 8px;
      overflow: hidden;
      background: #000; 
    }

    .main-media {
      width: 100%;
      height: var(--media-height-desktop);
      position: relative;
      display: block;
      overflow: hidden;
      background: #111;
    }

    .main-video,
    .main-image {
      width: 100%;
      height: 100%;
      display: block;
      object-fit: cover;
      border-radius: 0; 
    }

    /* hide video controls */
    .main-video::-webkit-media-controls { display: none !important; }
    .main-video { outline: none; pointer-events: none; } 

    /* thumbs */
    .thumbs {
      display: flex;
      gap: 8px;
      margin-top: 8px;
      flex-wrap: wrap;
    }
    .thumbs img {
      width: 72px;
      height: 56px;
      object-fit: cover;
      border-radius: 6px;
      cursor: pointer;
      opacity: .85;
      border: 2px solid transparent;
    }
    .thumbs img:focus,
    .thumbs img:hover { opacity: 1; border-color: rgba(15,111,189,0.12); }

    /* ========== LEFT CONTENT SECTIONS ========== */
    .section { margin-top: 18px; }
    .features { display:flex; flex-wrap:wrap; gap:12px; margin-top:8px; }
    .feature {
      background:#f3f6fb;
      padding:10px 12px;
      border-radius:8px;
      font-size:14px;
      color:#111;
    }

    /* floor plan tabs */
    .floors { margin-top:14px; }
    .tabs { display:flex; gap:8px; flex-wrap:wrap; }
    .tab {
      padding:8px 12px;
      border-radius:8px;
      background:#eef6ff;  
      color: #111;          
      cursor:pointer;
      border: none;
      font-size: 14px;
      transition: background 0.2s ease, color 0.2s ease;
    }
    .tab.active { background: var(--accent); color: #fff; }
  
    .tab:hover {
      background: #0b5fa8;   
      color: #fff;           
    }

    .floor-card {
      background:#fff;
      border-radius:8px;
      padding:12px;
      margin-top:12px;
      box-shadow:0 4px 12px rgba(16,24,40,0.04);
    }

    .download-link {
      display: inline-block;
      margin-top:14px;
      padding: 8px 12px;
      border-radius: 10px;
      background: #eef6ff;
      color: #0b5fa8;
      text-decoration: none;
      font-size: 14px;
      transition: background 0.2s ease, color 0.2s ease;
      margin-left: 8px;
    }

    .download-link:hover {
      background: #0b5fa8;
      color: #fff;
    }

    /* ========== RIGHT COLUMN: Sidebar ========== */
    aside { position:relative; }
    .price { font-size:20px; color:var(--accent); font-weight:700; }
    .specs { margin-top:12px; color:var(--muted); font-size:14px; }
    .cta {
      display:inline-block;
      margin-top:14px;
      padding:12px 16px;
      border-radius:10px;
      background:var(--accent);
      color:#fff;
      text-decoration:none;
    }

    form { display:grid; gap:10px; margin-top:12px; }
    input, textarea, select { padding:10px; border-radius:8px; border:1px solid #e6eef7; font-size:14px; }
    button { padding:10px; border-radius:8px; border:0; background:#0b5fa8; color:#fff; cursor:pointer; }

    footer { margin-top:18px; color:var(--muted); font-size:13px; }

    /* ========== MAP STYLES ========== */
    .map-wrapper {
      width: 100%;
      height: var(--map-height-mobile);
      background: #eef6ff;
      border-radius: 8px;
      display:flex;
      align-items:center;
      justify-content:center;
      color: var(--muted);
      overflow: hidden;
    }
    .map-wrapper iframe {
      width: 100%;
      height: 100%;
      border: 0;
      border-radius: 8px;
    }

    /* ========== RESPONSIVE RULES ========== */
    @media (max-width: 900px) {
      .grid { grid-template-columns: 1fr; }
      header { align-items: flex-start; }
      .hero-img { height: calc(var(--media-height-mobile)); min-width: auto; order: 0; }
      .main-media { height: calc(var(--media-height-mobile)); }
      .main-video, .main-image { height: 100%; }
      .carousel img { height: 200px; object-fit: cover; }
      .map-wrapper { height: var(--map-height-mobile); }
    }

    @media (min-width: 901px) {
      .main-media { height: var(--media-height-desktop); }
      .map-wrapper { height: var(--map-height-desktop); }
    }

    .popup {
      display: none;
      position: fixed;
      z-index: 999;
      left: 0; top: 0;
      width: 100%; height: 100%;
      background: rgba(0,0,0,0.8);
      justify-content: center;
      align-items: center;
    }
    .popup img {
      max-width: 90%;
      max-height: 90%;
      transition: transform 0.3s ease;
      cursor: grab;
    }
    .close {
      position: absolute;
      top: 20px; right: 40px;
      font-size: 40px;
      color: white;
      cursor: pointer;
    }
    .tab:focus, .cta:focus, button:focus, input:focus, textarea:focus { outline: 3px solid rgba(15,111,189,0.15); outline-offset: 2px; }
  </style>
</head>
<body>
  <div class="wrap">
    <div class="card">

      <header>
        <div class="hero-img" style="background-image: url('images/ArkaMainFrontElevation_compressed.jpg');" aria-hidden="true"></div>
        <div class="title">
          <h1>ARKA Towers - Prime 4-Floor Commercial Building — Pazhakutty- Vembayam SH-47 Road</h1>
          <div class="meta">Total rentable area: 6,000 sq ft (approx. 557 m²) • Zoning: Mixed Commercial (B2) • Available: September 2026</div>
        </div>
      </header>

      <div class="grid">
        <main>
          <div class="carousel" id="carousel">
            <div class="main-media" id="mainMediaContainer" aria-live="polite" aria-atomic="true">
              <video
                id="mainVideo"
                class="main-video"
                src="images/BuldingExterior.mp4"
                autoplay
                muted
                loop
                playsinline
                disablepictureinpicture
                controlsList="nodownload nofullscreen noplaybackrate noremoteplayback"
                preload="auto"
                aria-label="Building exterior video preview">
                Your browser does not support the video element.
              </video>
              <img id="mainImage" class="main-image" src="" alt="" style="display:none;" />
            </div>

            <div class="thumbs" id="thumbs" role="list">
              <img role="listitem" tabindex="0"
                   src="images/BuldingExterior.mp4_thumbnail.jpg"
                   data-src="images/BuldingExterior.mp4"
                   data-type="video"
                   alt="Exterior video thumbnail">

              <img role="listitem" tabindex="0"
                   src="https://placeholder.co/200x120?text=Exterior+1"
                   data-src="https://placeholder.co/1000x600?text=Building+Exterior"
                   data-type="image"
                   alt="Exterior photo thumbnail">

              <img role="listitem" tabindex="0"
                   src="https://placeholder.co/200x120?text=Lobby"
                   data-src="https://placeholder.co/1000x600?text=Lobby"
                   data-type="image"
                   alt="Lobby photo thumbnail">

              <img role="listitem" tabindex="0"
                   src="https://placeholder.co/200x120?text=Typical+Floor"
                   data-src="https://placeholder.co/1000x600?text=Typical+Floor"
                   data-type="image"
                   alt="Typical floor photo thumbnail">
            </div>
          </div>

          <section class="section">
            <h3>Versatile 4-Storey Commercial Space – Under Construction!</h3>
            <p class="muted">
              A modern commercial building now rising, featuring future-ready floor plates ideal for offices,
              showrooms, co-working, or light industrial use. Designed with a planned freight elevator and
              dedicated loading bay, this upcoming space offers flexibility, functionality, and a premium
              professional environment. Secure your space early and customise it to your business needs!
            </p>

            <div class="features">
              <div class="feature">Freight elevator</div>
              <div class="feature">Rooftop HVAC zones</div>
              <div class="feature">24/7 access & security</div>
              <div class="feature">Secured parking plot</div>
            </div>
          </section>

          <section class="section floors" aria-labelledby="floorTitle">
            <h3 id="floorTitle">Floor plans & availability</h3>
            <div class="tabs" role="tablist" aria-label="Floor selector">
              <button class="tab active" data-floor="1" role="tab" aria-selected="true">Ground / Floor 1</button>
              <button class="tab" data-floor="2" role="tab">Floor 2</button>
              <button class="tab" data-floor="3" role="tab">Floor 3</button>
              <button class="tab" data-floor="4" role="tab">Floor 4</button>
            </div>

            <div id="floorDetails"></div>

            <div id="imagePopup" class="popup">
              <span class="close" onclick="closePopup()">×</span>
              <img id="popupImage" src="" alt="Floor Image">
            </div>
          </section>

          <section class="section">
            <h3>Location & transport</h3>
            <p class="muted">Ideally positioned with excellent connectivity, the site is just <strong>5 minutes from Nedumangad Central</strong> and only <strong>1 minute walking distance from the nearest bus stop</strong>.</p>

            <div class="map-wrapper" aria-label="Map showing property location">
              <iframe
                src="https://www.google.com/maps/embed?pb=!1m14!1m12!1m3!1d1972.3981651918602!2d76.99192886665494!3d8.615542926153406!2m3!1f0!2f0!3f0!3m2!1i1024!2i768!4f13.1!5e0!3m2!1sen!2snl!4v1764029018771!5m2!1sen!2snl"
                loading="lazy"
                referrerpolicy="no-referrer-when-downgrade"
                allowfullscreen
                title="ARKA Towers location on map">
              </iframe>
            </div>
          </section>
        </main>

        <aside>
          <div class="card" style="padding:16px">
            <div class="price">₹ 45 / sq ft / month</div>
            <div class="specs">Negotiable lease term • Triple-net & maintenance options available</div>

            <a class="cta" href="mailto:arun_r@outlook.com?subject=Interest%20in%204-floor%20commercial%20building">Contact Leasing</a>

            <div class="section">
              <h4>Quick specs</h4>
              <ul class="specs">
                <li>Building area: 3,200 m² (approx.)</li>
                <li>Typical floor plate: 800 m²</li>
                <li>Ceiling height: 3.6 m (typ.)</li>
                <li>Power: 400V three-phase</li>
              </ul>
            </div>

            <div class="section">
              <h4>Request information / schedule viewing</h4>
              <form id="contactForm" >
                <input required type="text" id="name" placeholder="Full name" aria-label="Full name">
                <input required type="email" id="email" placeholder="Email" aria-label="Email">
                <input type="tel" id="phone" placeholder="Phone (optional)" aria-label="Phone number">
                <select id="intent" aria-label="Intent">
                  <option>Request brochure</option>
                  <option>Schedule a viewing</option>
                  <option>Discuss lease terms</option>
                </select>
                <textarea id="msg" rows="3" placeholder="Message (optional)" aria-label="Message"></textarea>
                <button type="submit">Send enquiry</button>
              </form>
              <div id="formMsg" style="margin-top:8px;color:var(--muted);font-size:13px"></div>
            </div>
          </div>
        </aside>
      </div>

      <footer>
        <div>Listing agent: Central Commercial Realty • Tel: +31 20 555 0123 • VAT/Company ID available on request</div>
      </footer>
    </div>
  </div>

  <script>
    /**************************************************************************
     * Carousel & thumbnail behavior
     **************************************************************************/
    (function(){
      const thumbs = document.getElementById('thumbs');
      const mainVideo = document.getElementById('mainVideo');
      const mainImage = document.getElementById('mainImage');

      function showVideo(src){
        if (mainVideo.getAttribute('src') !== src) {
          mainVideo.setAttribute('src', src);
          try { mainVideo.load(); } catch (e) { }
        }
        mainImage.style.display = 'none';
        mainImage.alt = '';
        mainVideo.style.display = 'block';
        mainVideo.muted = true;
        mainVideo.play().catch(()=>{});
      }

      function showImage(src, altText = ''){
        mainVideo.pause();
        mainVideo.style.display = 'none';
        mainImage.src = src;
        mainImage.alt = altText;
        mainImage.style.display = 'block';
      }

      if (mainVideo && mainVideo.getAttribute('src')) {
        showVideo(mainVideo.getAttribute('src'));
      }

      thumbs.addEventListener('click', function(e){
        const img = e.target.closest('img');
        if (!img) return;
        const src = img.dataset.src;
        const type = img.dataset.type || 'image';
        if (type === 'video') showVideo(src); else showImage(src, img.alt || 'Property image');
      });
    })();

    /**************************************************************************
     * Floor render logic
     **************************************************************************/
    (function(){
      const floors = {
        1: {title:'Ground / Floor 1 — Retail / Showroom', area:'900 m²', availability:'Available', notes:['High ceiling (4.5 m)','Direct street access','Loading bay & roll-up door'],floorimage:'images/GFL.png'},
        2: {title:'Floor 2 — Open-plan offices', area:'800 m²', availability:'Partially available', notes:['Raised floors','Plenty of natural light','Two passenger lifts'],floorimage:'images/2FL.png'},
        3: {title:'Floor 3 — Offices / Labs', area:'800 m²', availability:'Available from Jan 2026', notes:['Dedicated HVAC zones','Fume extraction capability'],floorimage:'images/3FL.png'},
        4: {title:'Floor 4 — Executive offices / Showroom', area:'700 m²', availability:'Available', notes:['Access to rooftop terrace','Panoramic views'],floorimage:'images/4FL.png'}
      };

      function renderFloor(n) {
        const f = floors[n];
        const container = document.getElementById('floorDetails');
        container.innerHTML = `
          <div class="floor-card" role="region" aria-labelledby="floor-${n}-title">
            <div style="display:flex;justify-content:space-between;align-items:center">
              <strong id="floor-${n}-title">${f.title}</strong>
              <span style="color:var(--muted)">${f.area} • ${f.availability}</span>
            </div>
            <div style="margin-top:10px;display:flex;gap:12px;align-items:flex-start;flex-wrap:wrap">
              <div style="flex:1;min-width:220px">
                <p style="margin:0;color:var(--muted)">${f.notes.join(' • ')}</p>
                <div style="margin-top:10px;">
                  <a href="mailto:arun_r@outlook.com?subject=Enquiry%20Floor%20${n}" class="cta" style="display:inline-block;padding:8px 12px;font-size:14px;text-decoration:none;margin-right:8px">Enquire about this floor</a>
                  <a href="${f.floorimage}" download="${f.title}.png" class="download-link">Download floor plan</a>
                </div>
              </div>
              <div style="width:180px;height:120px;background:#f7fbff;border-radius:8px;display:flex;align-items:center;justify-content:center;overflow:hidden">
                <img src="${f.floorimage}" alt="Floor ${f.title} plan" class="thumbnail" onclick="openPopup('${f.floorimage}')" style="max-width:100%;max-height:100%;object-fit:contain;border-radius:8px;" />
              </div>
            </div>
          </div>
        `;
      }

      let scale = 1;
      const popup = document.getElementById("imagePopup");
      const popupImage = document.getElementById("popupImage");

      window.openPopup = function(src) {
        popup.style.display = "flex";
        popupImage.src = src;
        scale = 1;
        popupImage.style.transform = "scale(1)";
      };

      window.closePopup = function() {
        popup.style.display = "none";
      };

      popupImage.addEventListener("wheel", function(e) {
        e.preventDefault();
        if (e.deltaY < 0) scale += 0.1;
        else scale = Math.max(0.1, scale - 0.1);
        popupImage.style.transform = `scale(${scale})`;
      });

      renderFloor(1);

      document.querySelectorAll('.tab').forEach(btn=>{
        btn.addEventListener('click', ()=>{
          document.querySelectorAll('.tab').forEach(t=>t.classList.remove('active'));
          btn.classList.add('active');
          renderFloor(btn.dataset.floor);
        });
      });
    })();

    /**************************************************************************
     * FORM HANDLER (FIXED FOR DATABASE)
     **************************************************************************/
    document.getElementById('contactForm').addEventListener('submit', async (e) => {
      e.preventDefault(); 
      const form = e.target;
      
      // FIX: Payload structure now matches backend Schema (Name, Email, Interest)
      const data = {
        name: form.name.value,
        email: form.email.value,
        phone: form.phone.value,
        interest: form.intent.value,
        message: form.msg.value,
        subject: "New Property Enquiry: " + form.intent.value
      };

      try {
        // Use config.js base URL if available, else localhost default
        const baseUrl = (window.__API_BASE__ || 'http://localhost:4000');
        const response = await fetch(baseUrl + '/send-email', {
          method: 'POST',
          headers: { 'Content-Type': 'application/json' },
          body: JSON.stringify(data),
        });

        if (response.ok) {
          document.getElementById('formMsg').textContent = `Enquiry sent successfully! The agent will contact you shortly.`;
          document.getElementById('contactForm').reset();
        } else {
          alert('Something went wrong.');
        }
      } catch (err) {
        console.error(err);
        alert('Error sending enquiry.');
      }
    });
  </script>
</body>
</html>